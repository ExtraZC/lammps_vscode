

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12.7. Python library interface &mdash; LAMMPS documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="LAMMPS documentation" href="index.html"/>
        <link rel="up" title="12. Use Python with LAMMPS" href="Python_head.html"/>
        <link rel="next" title="12.8. PyLammps interface" href="Python_pylammps.html"/>
        <link rel="prev" title="12.6. Test the Python/LAMMPS interface" href="Python_test.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="Manual.html">
        

        
          
          <img src="_static/lammps-logo.png" class="logo" />
        
        </a>

        <div class="lammps_version">Version: <b>19 Mar 2020</b></div>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">11. Modify &amp; extend LAMMPS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Python_head.html">12. Use Python with LAMMPS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Python_overview.html">12.1. Overview of Python and LAMMPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_run.html">12.2. Run LAMMPS from Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_shlib.html">12.3. Build LAMMPS as a shared library</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_install.html">12.4. Installing LAMMPS in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_mpi.html">12.5. Extending Python to run in parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_test.html">12.6. Test the Python/LAMMPS interface</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">12.7. Python library interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_pylammps.html">12.8. PyLammps interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_examples.html">12.9. Example Python scripts that use LAMMPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_call.html">12.10. Call Python from a LAMMPS input script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">13. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Manual_build.html">14. Building the LAMMPS manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="Manual.html">LAMMPS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="Manual.html">Docs</a> &raquo;</li>
      
          <li><a href="Python_head.html"><span class="section-number">12. </span>Use Python with LAMMPS</a> &raquo;</li>
      
    <li><span class="section-number">12.7. </span>Python library interface</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="http://lammps.sandia.gov">Website</a>
            <a href="Commands_all.html">Commands</a>
        
      </li>
  </ul>
  <hr style="margin-top: 6px; margin-bottom: 6px;" width="100%"/>
  
    <div class="rst-footer-buttons" style="margin-bottom: 1em" role="navigation" aria-label="footer navigation">
      
        <a href="Python_pylammps.html" class="btn btn-neutral float-right" title="12.8. PyLammps interface" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Python_test.html" class="btn btn-neutral" title="12.6. Test the Python/LAMMPS interface" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="python-library-interface">
<h1><span class="section-number">12.7. </span>Python library interface</h1>
<p>As described previously, the Python interface to LAMMPS consists of a
Python “lammps” module, the source code for which is in
python/lammps.py, which creates a “lammps” object, with a set of
methods that can be invoked on that object.  The sample Python code
below assumes you have first imported the “lammps” module in your
Python script, as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lammps</span> <span class="kn">import</span> <span class="n">lammps</span>
</pre></div>
</div>
<p>These are the methods defined by the lammps module.  If you look at
the files src/library.cpp and src/library.h you will see they
correspond one-to-one with calls you can make to the LAMMPS library
from a C++ or C or Fortran program, and which are described on the
<a class="reference internal" href="Howto_library.html"><span class="doc">Howto library</span></a> doc page.</p>
<p>The python/examples directory has Python scripts which show how Python
can run LAMMPS, grab data, change it, and put it back into LAMMPS.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">()</span>           <span class="c1"># create a LAMMPS object using the default liblammps.so library</span>
                         <span class="c1"># 4 optional args are allowed: name, cmdargs, ptr, comm</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">(</span><span class="n">ptr</span><span class="o">=</span><span class="n">lmpptr</span><span class="p">)</span> <span class="c1"># use lmpptr as previously created LAMMPS object</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">(</span><span class="n">comm</span><span class="o">=</span><span class="n">split</span><span class="p">)</span> <span class="c1"># create a LAMMPS object with a custom communicator, requires mpi4py 2.0.0 or later</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;g++&quot;</span><span class="p">)</span>   <span class="c1"># create a LAMMPS object using the liblammps_g++.so library</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;g++&quot;</span><span class="p">,</span><span class="n">cmdargs</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>    <span class="c1"># add LAMMPS command-line args, e.g. list = [&quot;-echo&quot;,&quot;screen&quot;]</span>

<span class="n">lmp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>              <span class="c1"># destroy a LAMMPS object</span>

<span class="n">version</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>  <span class="c1"># return the numerical version id, e.g. LAMMPS 2 Sep 2015 -&gt; 20150902</span>

<span class="n">lmp</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>           <span class="c1"># run an entire input script, file = &quot;in.lj&quot;</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>         <span class="c1"># invoke a single LAMMPS command, cmd = &quot;run 100&quot;</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">commands_list</span><span class="p">(</span><span class="n">cmdlist</span><span class="p">)</span>     <span class="c1"># invoke commands in cmdlist = **&quot;run 10&quot;, &quot;run 20&quot;**</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">commands_string</span><span class="p">(</span><span class="n">multicmd</span><span class="p">)</span>  <span class="c1"># invoke commands in multicmd = &quot;run 10\nrun 20&quot;</span>

<span class="n">size</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_setting</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>     <span class="c1"># return data type info</span>

<span class="n">xlo</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_global</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">)</span>  <span class="c1"># extract a global quantity</span>
                                     <span class="c1"># name = &quot;boxxlo&quot;, &quot;nlocal&quot;, etc</span>
                                     <span class="c1"># type = 0 = int</span>
                                     <span class="c1">#        1 = double</span>

<span class="n">boxlo</span><span class="p">,</span><span class="n">boxhi</span><span class="p">,</span><span class="n">xy</span><span class="p">,</span><span class="n">yz</span><span class="p">,</span><span class="n">xz</span><span class="p">,</span><span class="n">periodicity</span><span class="p">,</span><span class="n">box_change</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_box</span><span class="p">()</span>  <span class="c1"># extract box info</span>

<span class="n">coords</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_atom</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">)</span>      <span class="c1"># extract a per-atom quantity</span>
                                          <span class="c1"># name = &quot;x&quot;, &quot;type&quot;, etc</span>
                                          <span class="c1"># type = 0 = vector of ints</span>
                                          <span class="c1">#        1 = array of ints</span>
                                          <span class="c1">#        2 = vector of doubles</span>
                                          <span class="c1">#        3 = array of doubles</span>

<span class="n">eng</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_compute</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="nb">type</span><span class="p">)</span>  <span class="c1"># extract value(s) from a compute</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_fix</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>   <span class="c1"># extract value(s) from a fix</span>
                                          <span class="c1"># id = ID of compute or fix</span>
                                          <span class="c1"># style = 0 = global data</span>
                                          <span class="c1">#         1 = per-atom data</span>
                                          <span class="c1">#         2 = local data</span>
                                          <span class="c1"># type = 0 = scalar</span>
                                          <span class="c1">#        1 = vector</span>
                                          <span class="c1">#        2 = array</span>
                                          <span class="c1"># i,j = indices of value in global vector or array</span>

<span class="n">var</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">extract_variable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">group</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>  <span class="c1"># extract value(s) from a variable</span>
                                             <span class="c1"># name = name of variable</span>
                                             <span class="c1"># group = group ID (ignored for equal-style variables)</span>
                                             <span class="c1"># flag = 0 = equal-style variable</span>
                                             <span class="c1">#        1 = atom-style variable</span>

<span class="n">value</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">get_thermo</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>              <span class="c1"># return current value of a thermo keyword</span>
<span class="n">natoms</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">get_natoms</span><span class="p">()</span>                 <span class="c1"># total # of atoms as int</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>       <span class="c1"># set existing named string-style variable to value, flag = 0 if successful</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">reset_box</span><span class="p">(</span><span class="n">boxlo</span><span class="p">,</span><span class="n">boxhi</span><span class="p">,</span><span class="n">xy</span><span class="p">,</span><span class="n">yz</span><span class="p">,</span><span class="n">xz</span><span class="p">)</span>       <span class="c1"># reset the simulation box size</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">gather_atoms</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>  <span class="c1"># return per-atom property of all atoms gathered into data, ordered by atom ID</span>
                                          <span class="c1"># name = &quot;x&quot;, &quot;charge&quot;, &quot;type&quot;, etc</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">gather_atoms_concat</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>  <span class="c1"># ditto, but concatenated atom values from each proc (unordered)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">gather_atoms_subset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">count</span><span class="p">,</span><span class="n">ndata</span><span class="p">,</span><span class="n">ids</span><span class="p">)</span>  <span class="c1"># ditto, but for subset of Ndata atoms with IDs</span>

<span class="n">lmp</span><span class="o">.</span><span class="n">scatter_atoms</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">count</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>   <span class="c1"># scatter per-atom property to all atoms from data, ordered by atom ID</span>
                                          <span class="c1"># name = &quot;x&quot;, &quot;charge&quot;, &quot;type&quot;, etc</span>
                                          <span class="c1"># count = # of per-atom values, 1 or 3, etc</span>

<span class="n">lmp</span><span class="o">.</span><span class="n">scatter_atoms_subset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">count</span><span class="p">,</span><span class="n">ndata</span><span class="p">,</span><span class="n">ids</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># ditto, but for subset of Ndata atoms with IDs</span>

<span class="n">lmp</span><span class="o">.</span><span class="n">create_atoms</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ids</span><span class="p">,</span><span class="n">types</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">image</span><span class="p">,</span><span class="n">shrinkexceed</span><span class="p">)</span>   <span class="c1"># create N atoms with IDs, types, x, v, and image flags</span>
</pre></div>
</div>
<hr class="docutils" />
<p>The lines</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lammps</span> <span class="kn">import</span> <span class="n">lammps</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">()</span>
</pre></div>
</div>
<p>create an instance of LAMMPS, wrapped in a Python class by the lammps
Python module, and return an instance of the Python class as lmp.  It
is used to make all subsequent calls to the LAMMPS library.</p>
<p>Additional arguments to lammps() can be used to tell Python the name
of the shared library to load or to pass arguments to the LAMMPS
instance, the same as if LAMMPS were launched from a command-line
prompt.</p>
<p>If the ptr argument is set like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">(</span><span class="n">ptr</span><span class="o">=</span><span class="n">lmpptr</span><span class="p">)</span>
</pre></div>
</div>
<p>then lmpptr must be an argument passed to Python via the LAMMPS
<a class="reference internal" href="python.html"><span class="doc">python</span></a> command, when it is used to define a Python
function that is invoked by the LAMMPS input script.  This mode of
calling Python from LAMMPS is described in the <a class="reference internal" href="Python_call.html"><span class="doc">Python call</span></a> doc page.  The variable lmpptr refers to the
instance of LAMMPS that called the embedded Python interpreter.  Using
it as an argument to lammps() allows the returned Python class
instance “lmp” to make calls to that instance of LAMMPS.  See the
<a class="reference internal" href="python.html"><span class="doc">python</span></a> command doc page for examples using this syntax.</p>
<p>Note that you can create multiple LAMMPS objects in your Python
script, and coordinate and run multiple simulations, e.g.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lammps</span> <span class="kn">import</span> <span class="n">lammps</span>
<span class="n">lmp1</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">()</span>
<span class="n">lmp2</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">()</span>
<span class="n">lmp1</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s2">&quot;in.file1&quot;</span><span class="p">)</span>
<span class="n">lmp2</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s2">&quot;in.file2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The file(), command(), commands_list(), commands_string() methods
allow an input script, a single command, or multiple commands to be
invoked.</p>
<p>The extract_setting(), extract_global(), extract_box(),
extract_atom(), extract_compute(), extract_fix(), and
extract_variable() methods return values or pointers to data
structures internal to LAMMPS.</p>
<p>For extract_global() see the src/library.cpp file for the list of
valid names.  New names could easily be added.  A double or integer is
returned.  You need to specify the appropriate data type via the type
argument.</p>
<p>For extract_atom(), a pointer to internal LAMMPS atom-based data is
returned, which you can use via normal Python subscripting.  See the
extract() method in the src/atom.cpp file for a list of valid names.
Again, new names could easily be added if the property you want is not
listed.  A pointer to a vector of doubles or integers, or a pointer to
an array of doubles (double **) or integers (int **) is returned.  You
need to specify the appropriate data type via the type argument.</p>
<p>For extract_compute() and extract_fix(), the global, per-atom, or
local data calculated by the compute or fix can be accessed.  What is
returned depends on whether the compute or fix calculates a scalar or
vector or array.  For a scalar, a single double value is returned.  If
the compute or fix calculates a vector or array, a pointer to the
internal LAMMPS data is returned, which you can use via normal Python
subscripting.  The one exception is that for a fix that calculates a
global vector or array, a single double value from the vector or array
is returned, indexed by I (vector) or I and J (array).  I,J are
zero-based indices.  The I,J arguments can be left out if not needed.
See the <a class="reference internal" href="Howto_output.html"><span class="doc">Howto output</span></a> doc page for a discussion of
global, per-atom, and local data, and of scalar, vector, and array
data types.  See the doc pages for individual <a class="reference internal" href="compute.html"><span class="doc">computes</span></a>
and <a class="reference internal" href="fix.html"><span class="doc">fixes</span></a> for a description of what they calculate and
store.</p>
<p>For extract_variable(), an <a class="reference internal" href="variable.html"><span class="doc">equal-style or atom-style variable</span></a> is evaluated and its result returned.</p>
<p>For equal-style variables a single double value is returned and the
group argument is ignored.  For atom-style variables, a vector of
doubles is returned, one value per atom, which you can use via normal
Python subscripting. The values will be zero for atoms not in the
specified group.</p>
<p>The get_thermo() method returns the current value of a thermo
keyword as a float.</p>
<p>The get_natoms() method returns the total number of atoms in the
simulation, as an int.</p>
<p>The set_variable() method sets an existing string-style variable to a
new string value, so that subsequent LAMMPS commands can access the
variable.</p>
<p>The reset_box() method resets the size and shape of the simulation
box, e.g. as part of restoring a previously extracted and saved state
of a simulation.</p>
<p>The gather methods collect peratom info of the requested type (atom
coords, atom types, forces, etc) from all processors, and returns the
same vector of values to each calling processor.  The scatter
functions do the inverse.  They distribute a vector of peratom values,
passed by all calling processors, to individual atoms, which may be
owned by different processors.</p>
<p>Note that the data returned by the gather methods,
e.g. gather_atoms(“x”), is different from the data structure returned
by extract_atom(“x”) in four ways.  (1) Gather_atoms() returns a
vector which you index as x[i]; extract_atom() returns an array
which you index as x[i][j].  (2) Gather_atoms() orders the atoms
by atom ID while extract_atom() does not.  (3) Gather_atoms() returns
a list of all atoms in the simulation; extract_atoms() returns just
the atoms local to each processor.  (4) Finally, the gather_atoms()
data structure is a copy of the atom coords stored internally in
LAMMPS, whereas extract_atom() returns an array that effectively
points directly to the internal data.  This means you can change
values inside LAMMPS from Python by assigning a new values to the
extract_atom() array.  To do this with the gather_atoms() vector, you
need to change values in the vector, then invoke the scatter_atoms()
method.</p>
<p>For the scatter methods, the array of coordinates passed to must be a
ctypes vector of ints or doubles, allocated and initialized something
like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> \<span class="o">*</span>
<span class="n">natoms</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">get_natoms</span><span class="p">()</span>
<span class="n">n3</span> <span class="o">=</span> <span class="mi">3</span>\<span class="o">*</span><span class="n">natoms</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">n3</span>\<span class="o">*</span><span class="n">c_double</span><span class="p">)()</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="n">coord</span> <span class="n">of</span> <span class="n">atom</span> <span class="k">with</span> <span class="n">ID</span> <span class="mi">1</span>
<span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span> <span class="n">coord</span> <span class="n">of</span> <span class="n">atom</span> <span class="k">with</span> <span class="n">ID</span> <span class="mi">1</span>
<span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="n">coord</span> <span class="n">of</span> <span class="n">atom</span> <span class="k">with</span> <span class="n">ID</span> <span class="mi">1</span>
<span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="n">coord</span> <span class="n">of</span> <span class="n">atom</span> <span class="k">with</span> <span class="n">ID</span> <span class="mi">2</span>
<span class="o">...</span>
<span class="n">x</span><span class="p">[</span><span class="n">n3</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="n">coord</span> <span class="n">of</span> <span class="n">atom</span> <span class="k">with</span> <span class="n">ID</span> <span class="n">natoms</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">scatter_atoms</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can just change values in the vector returned by
the gather methods, since they are also ctypes vectors.</p>
<hr class="docutils" />
<p>As noted above, these Python class methods correspond one-to-one with
the functions in the LAMMPS library interface in src/library.cpp and
library.h.  This means you can extend the Python wrapper via the
following steps:</p>
<ul class="simple">
<li><p>Add a new interface function to src/library.cpp and
src/library.h.</p></li>
<li><p>Rebuild LAMMPS as a shared library.</p></li>
<li><p>Add a wrapper method to python/lammps.py for this interface
function.</p></li>
<li><p>You should now be able to invoke the new interface function from a
Python script.</p></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="lammps.lammps">
<em class="property">class </em><code class="sig-prename descclassname">lammps.</code><code class="sig-name descname">lammps</code><span class="sig-paren">(</span><em class="sig-param">name=''</em>, <em class="sig-param">cmdargs=None</em>, <em class="sig-param">ptr=None</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span></dt>
<dd><dl class="method">
<dt id="lammps.lammps.available_styles">
<code class="sig-name descname">available_styles</code><span class="sig-paren">(</span><em class="sig-param">category</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a list of styles available for a given category</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>category</strong> (<em>string</em>) – name of category</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of style names in given category</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.find_compute_neighlist">
<code class="sig-name descname">find_compute_neighlist</code><span class="sig-paren">(</span><em class="sig-param">computeid</em>, <em class="sig-param">request=0</em><span class="sig-paren">)</span></dt>
<dd><p>Find neighbor list index of compute neighbor list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>computeid</strong> (<em>string</em>) – name of compute</p></li>
<li><p><strong>request</strong> (<em>int</em><em>, </em><em>optional</em>) – index of neighbor list request, in case there are more than one, defaults to 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>neighbor list index if found, otherwise -1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.find_fix_neighlist">
<code class="sig-name descname">find_fix_neighlist</code><span class="sig-paren">(</span><em class="sig-param">fixid</em>, <em class="sig-param">request=0</em><span class="sig-paren">)</span></dt>
<dd><p>Find neighbor list index of fix neighbor list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fixid</strong> (<em>string</em>) – name of fix</p></li>
<li><p><strong>request</strong> (<em>int</em><em>, </em><em>optional</em>) – index of neighbor list request, in case there are more than one, defaults to 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>neighbor list index if found, otherwise -1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.find_pair_neighlist">
<code class="sig-name descname">find_pair_neighlist</code><span class="sig-paren">(</span><em class="sig-param">style</em>, <em class="sig-param">exact=True</em>, <em class="sig-param">nsub=0</em>, <em class="sig-param">request=0</em><span class="sig-paren">)</span></dt>
<dd><p>Find neighbor list index of pair style neighbor list</p>
<p>Try finding pair instance that matches style. If exact is set, the pair must
match style exactly. If exact is 0, style must only be contained. If pair is
of style pair/hybrid, style is instead matched the nsub-th hybrid sub-style.</p>
<p>Once the pair instance has been identified, multiple neighbor list requests
may be found. Every neighbor list is uniquely identified by its request
index. Thus, providing this request index ensures that the correct neighbor
list index is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>style</strong> (<em>string</em>) – name of pair style that should be searched for</p></li>
<li><p><strong>exact</strong> (<em>bool</em><em>, </em><em>optional</em>) – controls whether style should match exactly or only must be contained in pair style name, defaults to True</p></li>
<li><p><strong>nsub</strong> (<em>int</em><em>, </em><em>optional</em>) – match nsub-th hybrid sub-style, defaults to 0</p></li>
<li><p><strong>request</strong> (<em>int</em><em>, </em><em>optional</em>) – index of neighbor list request, in case there are more than one, defaults to 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>neighbor list index if found, otherwise -1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.get_neighlist">
<code class="sig-name descname">get_neighlist</code><span class="sig-paren">(</span><em class="sig-param">idx</em><span class="sig-paren">)</span></dt>
<dd><p>Returns an instance of <a class="reference internal" href="#lammps.NeighList" title="lammps.NeighList"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighList</span></code></a> which wraps access to the neighbor list with the given index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – index of neighbor list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an instance of <a class="reference internal" href="#lammps.NeighList" title="lammps.NeighList"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeighList</span></code></a> wrapping access to neighbor list data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lammps.NeighList" title="lammps.NeighList">NeighList</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.get_neighlist_element_neighbors">
<code class="sig-name descname">get_neighlist_element_neighbors</code><span class="sig-paren">(</span><em class="sig-param">idx</em>, <em class="sig-param">element</em><span class="sig-paren">)</span></dt>
<dd><p>Return data of neighbor list entry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> (<em>int</em>) – neighbor list index</p></li>
<li><p><strong>element</strong> – neighbor list element index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with atom local index, number of neighbors and array of neighbor local atom indices</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(int, int, numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.get_neighlist_size">
<code class="sig-name descname">get_neighlist_size</code><span class="sig-paren">(</span><em class="sig-param">idx</em><span class="sig-paren">)</span></dt>
<dd><p>Return the number of elements in neighbor list with the given index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – neighbor list index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of elements in neighbor list with index idx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.has_exceptions">
<em class="property">property </em><code class="sig-name descname">has_exceptions</code></dt>
<dd><p>Return whether the LAMMPS shared library was compiled with C++ exceptions handling enabled</p>
</dd></dl>

<dl class="method">
<dt id="lammps.lammps.has_style">
<code class="sig-name descname">has_style</code><span class="sig-paren">(</span><em class="sig-param">category</em>, <em class="sig-param">name</em><span class="sig-paren">)</span></dt>
<dd><p>Returns whether a given style name is available in a given category</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>category</strong> (<em>string</em>) – name of category</p></li>
<li><p><strong>name</strong> (<em>string</em>) – name of the style</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>true if style is available in given category</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lammps.NeighList">
<em class="property">class </em><code class="sig-prename descclassname">lammps.</code><code class="sig-name descname">NeighList</code><span class="sig-paren">(</span><em class="sig-param">lmp</em>, <em class="sig-param">idx</em><span class="sig-paren">)</span></dt>
<dd><p>This is a wrapper class that exposes the contents of a neighbor list</p>
<p>It can be used like a regular Python list.</p>
<p>Internally it uses the lower-level LAMMPS C-library interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lmp</strong> (<a class="reference internal" href="#lammps.lammps" title="lammps.lammps"><em>lammps</em></a>) – reference to instance of <a class="reference internal" href="#lammps.lammps" title="lammps.lammps"><code class="xref py py-class docutils literal notranslate"><span class="pre">lammps</span></code></a></p></li>
<li><p><strong>idx</strong> (<em>int</em>) – neighbor list index</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="lammps.NeighList.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">element</em><span class="sig-paren">)</span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tuple with atom local index, number of neighbors and array of neighbor local atom indices</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(int, int, numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lammps.NeighList.size">
<em class="property">property </em><code class="sig-name descname">size</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of elements in neighbor list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Python_pylammps.html" class="btn btn-neutral float-right" title="12.8. PyLammps interface" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Python_test.html" class="btn btn-neutral" title="12.6. Test the Python/LAMMPS interface" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr style="margin-top: 6px; margin-bottom: 6px;" width="100%"/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2003-2020 Sandia Corporation.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/mathjax/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>