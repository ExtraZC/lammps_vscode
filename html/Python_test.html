

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12.6. Test the Python/LAMMPS interface &mdash; LAMMPS documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="LAMMPS documentation" href="index.html"/>
        <link rel="up" title="12. Use Python with LAMMPS" href="Python_head.html"/>
        <link rel="next" title="12.7. Python library interface" href="Python_library.html"/>
        <link rel="prev" title="12.5. Extending Python to run in parallel" href="Python_mpi.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="Manual.html">
        

        
          
          <img src="_static/lammps-logo.png" class="logo" />
        
        </a>

        <div class="lammps_version">Version: <b>19 Mar 2020</b></div>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">11. Modify &amp; extend LAMMPS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Python_head.html">12. Use Python with LAMMPS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Python_overview.html">12.1. Overview of Python and LAMMPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_run.html">12.2. Run LAMMPS from Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_shlib.html">12.3. Build LAMMPS as a shared library</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_install.html">12.4. Installing LAMMPS in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_mpi.html">12.5. Extending Python to run in parallel</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">12.6. Test the Python/LAMMPS interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#test-lammps-and-python-in-serial">12.6.1. Test LAMMPS and Python in serial:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-lammps-and-python-in-parallel">12.6.2. Test LAMMPS and Python in parallel:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-python-scripts">12.6.3. Running Python scripts:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Python_library.html">12.7. Python library interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_pylammps.html">12.8. PyLammps interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_examples.html">12.9. Example Python scripts that use LAMMPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python_call.html">12.10. Call Python from a LAMMPS input script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">13. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Manual_build.html">14. Building the LAMMPS manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="Manual.html">LAMMPS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="Manual.html">Docs</a> &raquo;</li>
      
          <li><a href="Python_head.html"><span class="section-number">12. </span>Use Python with LAMMPS</a> &raquo;</li>
      
    <li><span class="section-number">12.6. </span>Test the Python/LAMMPS interface</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="http://lammps.sandia.gov">Website</a>
            <a href="Commands_all.html">Commands</a>
        
      </li>
  </ul>
  <hr style="margin-top: 6px; margin-bottom: 6px;" width="100%"/>
  
    <div class="rst-footer-buttons" style="margin-bottom: 1em" role="navigation" aria-label="footer navigation">
      
        <a href="Python_library.html" class="btn btn-neutral float-right" title="12.7. Python library interface" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Python_mpi.html" class="btn btn-neutral" title="12.5. Extending Python to run in parallel" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="test-the-python-lammps-interface">
<h1><span class="section-number">12.6. </span>Test the Python/LAMMPS interface</h1>
<p>To test if LAMMPS is callable from Python, launch Python interactively
and type:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from lammps import lammps
&gt;&gt;&gt; lmp = lammps()
</pre></div>
</div>
<p>If you get no errors, you’re ready to use LAMMPS from Python.  If the
2nd command fails, the most common error to see is</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OSError: Could not load LAMMPS dynamic library
</pre></div>
</div>
<p>which means Python was unable to load the LAMMPS shared library.  This
typically occurs if the system can’t find the LAMMPS shared library or
one of the auxiliary shared libraries it depends on, or if something
about the library is incompatible with your Python.  The error message
should give you an indication of what went wrong.</p>
<p>You can also test the load directly in Python as follows, without
first importing from the lammps.py file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from ctypes import CDLL
&gt;&gt;&gt; CDLL(&quot;liblammps.so&quot;)
</pre></div>
</div>
<p>If an error occurs, carefully go through the steps on the
<a class="reference internal" href="Build_basics.html"><span class="doc">Build_basics</span></a> doc page about building a shared
library and the <a class="reference internal" href="Python_install.html"><span class="doc">Python_install</span></a> doc page about
insuring Python can find the necessary two files it needs.</p>
<div class="section" id="test-lammps-and-python-in-serial">
<h2><span class="section-number">12.6.1. </span>Test LAMMPS and Python in serial:</h2>
<p>To run a LAMMPS test in serial, type these lines into Python
interactively from the bench directory:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from lammps import lammps
&gt;&gt;&gt; lmp = lammps()
&gt;&gt;&gt; lmp.file(&quot;in.lj&quot;)
</pre></div>
</div>
<p>Or put the same lines in the file test.py and run it as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>% python test.py
</pre></div>
</div>
<p>Either way, you should see the results of running the in.lj benchmark
on a single processor appear on the screen, the same as if you had
typed something like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lmp_g++ -in in.lj
</pre></div>
</div>
</div>
<div class="section" id="test-lammps-and-python-in-parallel">
<h2><span class="section-number">12.6.2. </span>Test LAMMPS and Python in parallel:</h2>
<p>To run LAMMPS in parallel, assuming you have installed the
<a class="reference external" href="https://github.com/daleroberts/pypar">PyPar</a> package as discussed
above, create a test.py file containing these lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pypar</span>
<span class="kn">from</span> <span class="nn">lammps</span> <span class="kn">import</span> <span class="n">lammps</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">()</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s2">&quot;in.lj&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Proc </span><span class="si">%d</span><span class="s2"> out of </span><span class="si">%d</span><span class="s2"> procs has&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pypar</span><span class="o">.</span><span class="n">rank</span><span class="p">(),</span><span class="n">pypar</span><span class="o">.</span><span class="n">size</span><span class="p">()),</span><span class="n">lmp</span>
<span class="n">pypar</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>To run LAMMPS in parallel, assuming you have installed the
<a class="reference external" href="https://bitbucket.org/mpi4py/mpi4py">mpi4py</a> package as discussed
above, create a test.py file containing these lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="kn">from</span> <span class="nn">lammps</span> <span class="kn">import</span> <span class="n">lammps</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">lammps</span><span class="p">()</span>
<span class="n">lmp</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s2">&quot;in.lj&quot;</span><span class="p">)</span>
<span class="n">me</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span>
<span class="n">nprocs</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">Get_size</span><span class="p">()</span>
<span class="nb">print</span> <span class="s2">&quot;Proc </span><span class="si">%d</span><span class="s2"> out of </span><span class="si">%d</span><span class="s2"> procs has&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">nprocs</span><span class="p">),</span><span class="n">lmp</span>
<span class="n">MPI</span><span class="o">.</span><span class="n">Finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>You can either script in parallel as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>% mpirun -np <span class="m">4</span> python test.py
</pre></div>
</div>
<p>and you should see the same output as if you had typed</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>% mpirun -np <span class="m">4</span> lmp_g++ -in in.lj
</pre></div>
</div>
<p>Note that if you leave out the 3 lines from test.py that specify PyPar
commands you will instantiate and run LAMMPS independently on each of
the P processors specified in the mpirun command.  In this case you
should get 4 sets of output, each showing that a LAMMPS run was made
on a single processor, instead of one set of output showing that
LAMMPS ran on 4 processors.  If the 1-processor outputs occur, it
means that PyPar is not working correctly.</p>
<p>Also note that once you import the PyPar module, PyPar initializes MPI
for you, and you can use MPI calls directly in your Python script, as
described in the PyPar documentation.  The last line of your Python
script should be pypar.finalize(), to insure MPI is shut down
correctly.</p>
</div>
<div class="section" id="running-python-scripts">
<h2><span class="section-number">12.6.3. </span>Running Python scripts:</h2>
<p>Note that any Python script (not just for LAMMPS) can be invoked in
one of several ways:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>% python foo.script
% python -i foo.script
% foo.script
</pre></div>
</div>
<p>The last command requires that the first line of the script be
something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/local/bin/python</span>
<span class="c1">#!/usr/local/bin/python -i</span>
</pre></div>
</div>
<p>where the path points to where you have Python installed, and that you
have made the script file executable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>% chmod +x foo.script
</pre></div>
</div>
<p>Without the “-i” flag, Python will exit when the script finishes.
With the “-i” flag, you will be left in the Python interpreter when
the script finishes, so you can type subsequent commands.  As
mentioned above, you can only run Python interactively when running
Python on a single processor, not in parallel.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Python_library.html" class="btn btn-neutral float-right" title="12.7. Python library interface" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Python_mpi.html" class="btn btn-neutral" title="12.5. Extending Python to run in parallel" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr style="margin-top: 6px; margin-bottom: 6px;" width="100%"/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2003-2020 Sandia Corporation.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/mathjax/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>