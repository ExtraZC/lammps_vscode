

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.4. Basic build options &mdash; LAMMPS documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="LAMMPS documentation" href="index.html"/>
        <link rel="up" title="3. Build LAMMPS" href="Build.html"/>
        <link rel="next" title="3.5. Optional build settings" href="Build_settings.html"/>
        <link rel="prev" title="3.3. Link LAMMPS as a library to another code" href="Build_link.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="Manual.html">
        

        
          
          <img src="_static/lammps-logo.png" class="logo" />
        
        </a>

        <div class="lammps_version">Version: <b>19 Mar 2020</b></div>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Build.html">3. Build LAMMPS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Build_cmake.html">3.1. Build LAMMPS with CMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_make.html">3.2. Build LAMMPS with make</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_link.html">3.3. Link LAMMPS as a library to another code</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.4. Basic build options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#serial-vs-parallel-build">3.4.1. Serial vs parallel build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#choice-of-compiler-and-compile-link-options">3.4.2. Choice of compiler and compile/link options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-lammps-as-an-executable-or-a-library">3.4.3. Build LAMMPS as an executable or a library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-the-lammps-documentation">3.4.4. Build the LAMMPS documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-lammps-tools">3.4.5. Build LAMMPS tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-lammps-after-a-build">3.4.6. Install LAMMPS after a build</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Build_settings.html">3.5. Optional build settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_package.html">3.6. Include packages in build</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_extras.html">3.7. Packages with extra build options</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_windows.html">3.8. Notes for building LAMMPS on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_development.html">3.9. Development build options (CMake only)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">11. Modify &amp; extend LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">12. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">13. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Manual_build.html">14. Building the LAMMPS manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="Manual.html">LAMMPS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="Manual.html">Docs</a> &raquo;</li>
      
          <li><a href="Build.html"><span class="section-number">3. </span>Build LAMMPS</a> &raquo;</li>
      
    <li><span class="section-number">3.4. </span>Basic build options</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="http://lammps.sandia.gov">Website</a>
            <a href="Commands_all.html">Commands</a>
        
      </li>
  </ul>
  <hr style="margin-top: 6px; margin-bottom: 6px;" width="100%"/>
  
    <div class="rst-footer-buttons" style="margin-bottom: 1em" role="navigation" aria-label="footer navigation">
      
        <a href="Build_settings.html" class="btn btn-neutral float-right" title="3.5. Optional build settings" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Build_link.html" class="btn btn-neutral" title="3.3. Link LAMMPS as a library to another code" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basic-build-options">
<h1><span class="section-number">3.4. </span>Basic build options</h1>
<p>The following topics are covered on this page, for building both with
CMake and make:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#serial"><span class="std std-ref">Serial vs parallel build</span></a></p></li>
<li><p><a class="reference internal" href="#compile"><span class="std std-ref">Choice of compiler and compile/link options</span></a></p></li>
<li><p><a class="reference internal" href="#exe"><span class="std std-ref">Build LAMMPS as an executable or a library</span></a></p></li>
<li><p><a class="reference internal" href="#doc"><span class="std std-ref">Build the LAMMPS documentation</span></a></p></li>
<li><p><a class="reference internal" href="#install"><span class="std std-ref">Install LAMMPS after a build</span></a></p></li>
</ul>
<hr class="docutils" />
<div class="section" id="serial-vs-parallel-build">
<span id="serial"></span><h2><span class="section-number">3.4.1. </span>Serial vs parallel build</h2>
<p>LAMMPS is written to use the ubiquitous <a class="reference external" href="https://en.wikipedia.org/wiki/Message_Passing_Interface">MPI (Message Passing Interface)</a> library API
for distributed memory parallel computation.  You need to have such a
library installed for building and running LAMMPS in parallel using a
domain decomposition parallelization.  It is compatible with the MPI
standard version 2.x and later.  LAMMPS can also be built into a
“serial” executable for use with a single processor using the bundled
MPI STUBS library.</p>
<p>Independent of the distributed memory MPI parallelization, parts of
LAMMPS are also written with support for shared memory parallelization
using the OpenMP threading standard. A more detailed discussion of that
is below.</p>
<p><strong>CMake build</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-D <span class="nv">BUILD_MPI</span><span class="o">=</span>value        <span class="c1"># yes or no, default is yes if CMake finds MPI, else no</span>
-D <span class="nv">BUILD_OMP</span><span class="o">=</span>value        <span class="c1"># yes or no, default is yes if a compatible compiler is detected</span>
-D <span class="nv">LAMMPS_MACHINE</span><span class="o">=</span>name    <span class="c1"># name = mpi, serial, mybox, titan, laptop, etc</span>
                          <span class="c1"># no default value</span>
</pre></div>
</div>
<p>The executable created by CMake (after running make) is named <code class="docutils literal notranslate"><span class="pre">lmp</span></code> unless
the LAMMPS_MACHINE option is set.  When setting <code class="docutils literal notranslate"><span class="pre">LAMMPS_MACHINE=name</span></code>
the executable will be called <code class="docutils literal notranslate"><span class="pre">lmp_name</span></code>.  Using <code class="docutils literal notranslate"><span class="pre">BUILD_MPI=no</span></code> will
enforce building a serial executable using the MPI STUBS library.</p>
<p><strong>Traditional make</strong>:</p>
<p>The build with traditional makefiles has to be done inside the source folder <code class="docutils literal notranslate"><span class="pre">src</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make mpi                <span class="c1"># parallel build, produces lmp_mpi using Makefile.mpi</span>
make serial             <span class="c1"># serial build, produces lmp_serial using Makefile/serial</span>
make mybox              <span class="c1"># uses Makefile.mybox to produce lmp_mybox</span>
</pre></div>
</div>
<p>Any “make machine” command will look up the make settings from a file
Makefile.machine, create a folder Obj_machine with all objects and
generated files and an executable called <code class="docutils literal notranslate"><span class="pre">lmp_machine</span></code>.  The standard
parallel build with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">mpi</span></code> assumes a standard MPI installation with
MPI compiler wrappers where all necessary compiler and linker flags to
get access and link with the suitable MPI headers and libraries are set
by the wrapper programs.  For other cases or the serial build, you have
to adjust the make file variables <code class="docutils literal notranslate"><span class="pre">MPI_INC</span></code>, <code class="docutils literal notranslate"><span class="pre">MPI_PATH</span></code>, <code class="docutils literal notranslate"><span class="pre">MPI_LIB</span></code>
as well as <code class="docutils literal notranslate"><span class="pre">CC</span></code> and <code class="docutils literal notranslate"><span class="pre">LINK</span></code>.  To enable OpenMP threading usually
a compiler specific flag needs to be added to the compile and link
commands.  For the GNU compilers, this is <code class="docutils literal notranslate"><span class="pre">-fopenmp</span></code>, which can be
added to the <code class="docutils literal notranslate"><span class="pre">CC</span></code> and <code class="docutils literal notranslate"><span class="pre">LINK</span></code> makefile variables.</p>
<p>For the serial build the following make variables are set (see src/MAKE/Makefile.serial):</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span> <span class="o">=</span>            g++
<span class="nv">LINK</span> <span class="o">=</span>          g++
<span class="nv">MPI_INC</span> <span class="o">=</span>       -I../STUBS
<span class="nv">MPI_PATH</span> <span class="o">=</span>      -L../STUBS
<span class="nv">MPI_LIB</span> <span class="o">=</span>       -lmpi_stubs
</pre></div>
</div>
<p>You also need to build the STUBS library for your platform before making
LAMMPS itself.  A <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">serial</span></code> build does this for you automatically,
otherwise, type <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">mpi-stubs</span></code> from the src directory, or <code class="docutils literal notranslate"><span class="pre">make</span></code> from
the src/STUBS dir.  If the build fails, you will need to edit the
STUBS/Makefile for your platform.  The stubs library does not provide
MPI/IO functions required by some LAMMPS packages, e.g. MPIIO or USER-LB,
and thus is not compatible with those packages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">src/STUBS/mpi.c</span></code> provides a CPU timer function called
MPI_Wtime() that calls gettimeofday() .  If your operating system
does not support gettimeofday() , you will need to insert code to
call another timer.  Note that the ANSI-standard function clock()
rolls over after an hour or so, and is therefore insufficient for
timing long LAMMPS simulations.</p>
</div>
<p><strong>MPI and OpenMP support info</strong>:</p>
<p>If you are installing MPI yourself to build a parallel LAMMPS
executable, we recommend either MPICH or OpenMPI which are regularly
used and tested with LAMMPS by the LAMMPS developers.  MPICH can be
downloaded from the <a class="reference external" href="https://www.mpich.org">MPICH home page</a> and
OpenMPI can be downloaded correspondingly from the <a class="reference external" href="https://www.open-mpi.org">OpenMPI home page</a>.  Other MPI packages should also work.  No
specific vendor provided and standard compliant MPI library is currently
known to be incompatible with LAMMPS.  If you are running on a large
parallel machine, your system admins or the vendor should have already
installed a version of MPI, which is likely to be faster than a
self-installed MPICH or OpenMPI, so you should study the provided
documentation to find out how to build and link with it.</p>
<p>The majority of OpenMP (threading) support in LAMMPS is provided by the
USER-OMP package; see the <a class="reference internal" href="Speed_omp.html"><span class="doc">Speed omp</span></a> doc page for
details. The USER-INTEL package also includes OpenMP threading (it is
compatible with USER-OMP) and adds vectorization support when compiled
with compatible compilers, in particular the Intel compilers on top of
OpenMP. Also, the KOKKOS package can be compiled to include OpenMP
threading.</p>
<p>In addition, there are a few commands in LAMMPS that have native OpenMP
support included as well.  These are commands in the MPIIO, SNAP,
USER-DIFFRACTION, and USER-DPD packages.  In addition some packages
support OpenMP threading indirectly through the libraries they interface
to: e.g. LATTE and USER-COLVARS.  See the <a class="reference internal" href="Packages_details.html"><span class="doc">Packages details</span></a> doc page for more info on these packages and the doc
pages for their respective commands for OpenMP threading info.</p>
<p>For CMake, if you use <code class="docutils literal notranslate"><span class="pre">BUILD_OMP=yes</span></code>, you can use these packages
and turn on their native OpenMP support and turn on their native OpenMP
support at run time, by setting the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> environment
variable before you launch LAMMPS.</p>
<p>For building via conventional make, the <code class="docutils literal notranslate"><span class="pre">CCFLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">LINKFLAGS</span></code>
variables in Makefile.machine need to include the compiler flag that
enables OpenMP. For GNU compilers it is <code class="docutils literal notranslate"><span class="pre">-fopenmp</span></code>.  For (recent) Intel
compilers it is <code class="docutils literal notranslate"><span class="pre">-qopenmp</span></code>.  If you are using a different compiler,
please refer to its documentation.</p>
<p id="default-none-issues"><strong>OpenMP Compiler compatibility info</strong>:</p>
<p>Some compilers do not fully support the <code class="docutils literal notranslate"><span class="pre">default(none)</span></code> directive
and others (e.g. GCC version 9 and beyond) may implement OpenMP 4.0
semantics, which are incompatible with the OpenMP 3.1 semantics used
in LAMMPS (for maximal compatibility with compiler versions in use).
In those case, all <code class="docutils literal notranslate"><span class="pre">default(none)</span></code> directives (which aid in detecting
incorrect and unwanted sharing) can be replaced with <code class="docutils literal notranslate"><span class="pre">default(shared)</span></code>
while dropping all <code class="docutils literal notranslate"><span class="pre">shared()</span></code> directives. The script
‘src/USER-OMP/hack_openmp_for_pgi_gcc9.sh’ can be used to automate
this conversion.</p>
<hr class="docutils" />
</div>
<div class="section" id="choice-of-compiler-and-compile-link-options">
<span id="compile"></span><h2><span class="section-number">3.4.2. </span>Choice of compiler and compile/link options</h2>
<p>The choice of compiler and compiler flags can be important for
performance.  Vendor provided compilers for a specific hardware can
produce faster code than open-source compilers like the GNU compilers.
On x86 hardware most popular compilers are quite similar in performance
of C/C++ code at high optimization levels.  When using the USER-INTEL
package, there is a distinct advantage in using the <a class="reference external" href="https://software.intel.com/en-us/intel-compilers">Intel C++ compiler</a> due to much improved vectorization through SSE and AVX
instructions on compatible hardware as the source code includes changes
and compiler directives to enable high degrees of vectorization.</p>
<p>On parallel clusters or supercomputers which use “environment modules”
for their compile/link environments, you can often access different
compilers by simply loading the appropriate module before building
LAMMPS.</p>
<p><strong>CMake build</strong>:</p>
<p>By default CMake will use a compiler it finds and it will add
optimization flags appropriate to that compiler and any
<a class="reference internal" href="Speed_packages.html"><span class="doc">accelerator packages</span></a> you have included in the
build.</p>
<p>You can tell CMake to look for a specific compiler with these variable
settings.  Likewise you can specify the corresponding <code class="docutils literal notranslate"><span class="pre">CMAKE_*_FLAGS</span></code>
variables if you want to experiment with alternate optimization flags.
You should specify all 3 compilers, so that the small number of LAMMPS
source files written in C or Fortran are built with a compiler consistent
with the one used for all the C++ files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-D <span class="nv">CMAKE_CXX_COMPILER</span><span class="o">=</span>name            <span class="c1"># name of C++ compiler</span>
-D <span class="nv">CMAKE_C_COMPILER</span><span class="o">=</span>name              <span class="c1"># name of C compiler</span>
-D <span class="nv">CMAKE_Fortran_COMPILER</span><span class="o">=</span>name        <span class="c1"># name of Fortran compiler</span>

-D <span class="nv">CMAKE_CXX_FLAGS</span><span class="o">=</span>string             <span class="c1"># flags to use with C++ compiler</span>
-D <span class="nv">CMAKE_C_FLAGS</span><span class="o">=</span>string               <span class="c1"># flags to use with C compiler</span>
-D <span class="nv">CMAKE_Fortran_FLAGS</span><span class="o">=</span>string         <span class="c1"># flags to use with Fortran compiler</span>
</pre></div>
</div>
<p>A few example command lines are:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Building with GNU Compilers:</span>
cmake ../cmake -DCMAKE_C_COMPILER<span class="o">=</span>gcc -DCMAKE_CXX_COMPILER<span class="o">=</span>g++ -DCMAKE_Fortran_COMPILER<span class="o">=</span>gfortran
<span class="c1"># Building with Intel Compilers:</span>
cmake ../cmake -DCMAKE_C_COMPILER<span class="o">=</span>icc -DCMAKE_CXX_COMPILER<span class="o">=</span>icpc -DCMAKE_Fortran_COMPILER<span class="o">=</span>ifort
<span class="c1"># Building with LLVM/Clang Compilers:</span>
cmake ../cmake -DCMAKE_C_COMPILER<span class="o">=</span>clang -DCMAKE_CXX_COMPILER<span class="o">=</span>clang++ -DCMAKE_Fortran_COMPILER<span class="o">=</span>flang
</pre></div>
</div>
<p>For compiling with the Clang/LLVM compilers a special CMake preset is
included that can be loaded with <cite>-C ../cmake/presets/clang.cmake</cite>.</p>
<p>In addition you can set <code class="docutils literal notranslate"><span class="pre">CMAKE_TUNE_FLAGS</span></code> to specifically add compiler
flags to tune for optimal performance on given hosts. By default these are
initialized to some compiler specific flags, where known, to optimize the
LAMMPS executable with optimizations and instructions available on the host
where LAMMPS is compiled. For example, for Intel compilers this would be
<code class="docutils literal notranslate"><span class="pre">-xHost</span></code> and for GNU compilers this would be <code class="docutils literal notranslate"><span class="pre">-march=native</span></code>. To turn
these flags off, set <code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">CMAKE_TUNE_FLAGS=</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the cmake command completes, it prints a summary to the screen
which compilers it is using and what flags and settings will be used
for the  compilation.  Note that if the top-level compiler is mpicxx,
it is simply a wrapper on a real compiler.  The underlying compiler
info is what CMake will try to determine and report.  You should check
to confirm you are using the compiler and optimization flags you want.</p>
</div>
<p><strong>Makefile.machine settings for traditional make</strong>:</p>
<p>The “compiler/linker settings” section of a Makefile.machine lists
compiler and linker settings for your C++ compiler, including
optimization flags.  For a parallel build it is recommended to use
mpicxx or mpiCC, since these compiler wrappers will include a variety of
settings appropriate for your MPI installation and thus avoiding the
guesswork of finding the right flags.</p>
<p>Parallel build (see src/MAKE/Makefile.mpi):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span> <span class="o">=</span>            mpicxx
<span class="nv">CCFLAGS</span> <span class="o">=</span>       -g -O3
<span class="nv">LINK</span> <span class="o">=</span>          mpicxx
<span class="nv">LINKFLAGS</span> <span class="o">=</span>     -g -O
</pre></div>
</div>
<p>Serial build (see src/MAKE/Makefile.serial):</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span> <span class="o">=</span>            g++
<span class="nv">CCFLAGS</span> <span class="o">=</span>       -g -O3
<span class="nv">LINK</span> <span class="o">=</span>          g++
<span class="nv">LINKFLAGS</span> <span class="o">=</span>     -g -O
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you build LAMMPS with any <a class="reference internal" href="Speed_packages.html"><span class="doc">accelerator packages</span></a>
included, there may be specific optimization flags that are either
required or recommended to enable required features and to achieve
optimal performance.  You need to include these in the CCFLAGS and
LINKFLAGS settings above.  For details, see the individual package
doc pages listed on the <a class="reference internal" href="Speed_packages.html"><span class="doc">Speed packages</span></a> doc
page.  Or examine these files in the src/MAKE/OPTIONS directory.
They correspond to each of the 5 accelerator packages and their
hardware variants:</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Makefile.opt                   <span class="c1"># OPT package</span>
Makefile.omp                   <span class="c1"># USER-OMP package</span>
Makefile.intel_cpu             <span class="c1"># USER-INTEL package for CPUs</span>
Makefile.intel_coprocessor     <span class="c1"># USER-INTEL package for KNLs</span>
Makefile.gpu                   <span class="c1"># GPU package</span>
Makefile.kokkos_cuda_mpi       <span class="c1"># KOKKOS package for GPUs</span>
Makefile.kokkos_omp            <span class="c1"># KOKKOS package for CPUs (OpenMP)</span>
Makefile.kokkos_phi            <span class="c1"># KOKKOS package for KNLs (OpenMP)</span>
</pre></div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="build-lammps-as-an-executable-or-a-library">
<span id="exe"></span><h2><span class="section-number">3.4.3. </span>Build LAMMPS as an executable or a library</h2>
<p>LAMMPS can be built as either an executable or as a static or shared
library.  The LAMMPS library can be called from another application or
a scripting language.  See the <a class="reference internal" href="Howto_couple.html"><span class="doc">Howto couple</span></a> doc
page for more info on coupling LAMMPS to other codes.  See the
<a class="reference internal" href="Python_head.html"><span class="doc">Python</span></a> doc page for more info on wrapping and
running LAMMPS from Python via its library interface.</p>
<p><strong>CMake build</strong>:</p>
<p>For CMake builds, you can select through setting CMake variables which
files the compilation produces during the configuration step.  If none
are set, defaults are applied.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-D <span class="nv">BUILD_EXE</span><span class="o">=</span>value           <span class="c1"># yes (default) or no</span>
-D <span class="nv">BUILD_LIB</span><span class="o">=</span>value           <span class="c1"># yes or no (default)</span>
-D <span class="nv">BUILD_SHARED_LIBS</span><span class="o">=</span>value   <span class="c1"># yes or no (default)</span>
-D <span class="nv">LAMMPS_LIB_SUFFIX</span><span class="o">=</span>name    <span class="c1"># name = mpi, serial, mybox, titan, laptop, etc</span>
                             <span class="c1"># no default value</span>
</pre></div>
</div>
<p>Setting <code class="docutils literal notranslate"><span class="pre">BUILD_EXE=no</span></code> will not produce an executable.  Setting
<code class="docutils literal notranslate"><span class="pre">BUILD_LIB=yes</span></code> will produce a static library named <code class="docutils literal notranslate"><span class="pre">liblammps.a</span></code>.
Setting both <code class="docutils literal notranslate"><span class="pre">BUILD_LIB=yes</span></code> and <code class="docutils literal notranslate"><span class="pre">BUILD_SHARED_LIBS=yes</span></code> will produce a
shared library named <code class="docutils literal notranslate"><span class="pre">liblammps.so</span></code> instead. If <code class="docutils literal notranslate"><span class="pre">LAMMPS_LIB_SUFFIX=name</span></code>
is set in addition, the name of the generated libraries will be changed to
either <code class="docutils literal notranslate"><span class="pre">liblammps_name.a</span></code> or <code class="docutils literal notranslate"><span class="pre">liblammps_name.so</span></code>, respectively.</p>
<p><strong>Traditional make</strong>:</p>
<p>With the traditional makefile based build process, the choice of
the generated executable or library depends on the “mode” setting.
Several options are available and <code class="docutils literal notranslate"><span class="pre">mode=exe</span></code> is the default.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make machine               <span class="c1"># build LAMMPS executable lmp_machine</span>
make <span class="nv">mode</span><span class="o">=</span>exe machine      <span class="c1"># same as &quot;make machine&quot;</span>
make <span class="nv">mode</span><span class="o">=</span>lib machine      <span class="c1"># build LAMMPS static lib liblammps_machine.a</span>
make <span class="nv">mode</span><span class="o">=</span>shlib machine    <span class="c1"># build LAMMPS shared lib liblammps_machine.so</span>
make <span class="nv">mode</span><span class="o">=</span>shexe machine    <span class="c1"># same as &quot;mode=exe&quot; but uses objects from &quot;mode=shlib&quot;</span>
</pre></div>
</div>
<p>The two “exe” builds will generate and executable <code class="docutils literal notranslate"><span class="pre">lmp_machine</span></code>,
while the two library builds will create a file <code class="docutils literal notranslate"><span class="pre">liblammps_machine.a</span></code>
or <code class="docutils literal notranslate"><span class="pre">liblammps_machine.so</span></code>. They will also create generic soft links,
named <code class="docutils literal notranslate"><span class="pre">liblammps.a</span></code> and <code class="docutils literal notranslate"><span class="pre">liblammps.so</span></code>, which point to the specific
<code class="docutils literal notranslate"><span class="pre">liblammps_machine.a/so</span></code> files.</p>
<p><strong>CMake and make info</strong>:</p>
<p>Note that for a shared library to be usable by a calling program, all
the auxiliary libraries it depends on must also exist as shared
libraries.  This will be the case for libraries included with LAMMPS,
such as the dummy MPI library in src/STUBS or any package libraries in
the lib/packages directory, since they are always built in a shared
library compatible way using the <code class="docutils literal notranslate"><span class="pre">-fPIC</span></code> switch.  However, if a library
like MPI or FFTW does not exist as a shared library, the shared library
build may generate an error.  This means you will need to install a
shared library version of the auxiliary library.  The build instructions
for the library should tell you how to do this.</p>
<p>As an example, here is how to build and install the <a class="reference external" href="https://www.mpich.org">MPICH library</a>, a popular open-source version of MPI, as a shared library
in the default /usr/local/lib location:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure --enable-shared
make
make install
</pre></div>
</div>
<p>You may need to use <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></code> in place of the last line if you
do not have write privileges for <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>.  The end result should
be the file <code class="docutils literal notranslate"><span class="pre">/usr/local/lib/libmpich.so</span></code>.  On many Linux installations the
folder <code class="docutils literal notranslate"><span class="pre">${HOME}/.local</span></code> is an alternative to using <code class="docutils literal notranslate"><span class="pre">/usr/local</span></code> and does
not require superuser or sudo access.  In that case the configuration
step becomes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure --enable-shared --prefix<span class="o">=</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/.local
</pre></div>
</div>
<p>Avoiding using “sudo” for custom software installation (i.e. from source
and not through a package manager tool provided by the OS) is generally
recommended to ensure the integrity of the system software installation.</p>
<hr class="docutils" />
</div>
<div class="section" id="build-the-lammps-documentation">
<span id="doc"></span><h2><span class="section-number">3.4.4. </span>Build the LAMMPS documentation</h2>
<p>The LAMMPS manual is written in <a class="reference external" href="https://docutils.readthedocs.io/en/sphinx-docs/user/rst/quickstart.html">reStructuredText</a> format which
can be translated to different output format using the <a class="reference external" href="https://sphinx-doc.org">Sphinx</a>
document generator tool.  Currently the translation to HTML and PDF (via
LaTeX) are supported.  For that to work a Python 3 interpreter and
internet access is required.  For the documentation build a python
based virtual environment is set up in the folder doc/docenv and various
python packages are installed into that virtual environment via the pip
tool.  The actual translation is then done via make commands.</p>
<p><strong>Documentation make option</strong>:</p>
<p>The following make commands can be issued in the doc folder of the
LAMMPS source distribution.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make html          <span class="c1"># create HTML doc pages in html directory</span>
make pdf           <span class="c1"># create Developer.pdf and Manual.pdf in this directory</span>
make fetch         <span class="c1"># fetch HTML and PDF files from LAMMPS web site</span>
make clean         <span class="c1"># remove all intermediate files</span>
make clean-all     <span class="c1"># reset the entire doc build environment</span>
make anchor_check  <span class="c1"># scan for duplicate anchor labels</span>
make style_check   <span class="c1"># check for complete and consistent style lists</span>
make package_check <span class="c1"># check for complete and consistent package lists</span>
make spelling      <span class="c1"># spell-check the manual</span>
</pre></div>
</div>
<p>Thus “make html” will create a “doc/html” directory with the HTML format
manual pages so that you can browse them with a web browser locally on
your system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also download a tarball of the documentation for the
current LAMMPS version (HTML and PDF files), from the website
<a class="reference external" href="https://lammps.sandia.gov/download.html">download page</a>.</p>
</div>
<p><strong>CMake build option</strong>:</p>
<p>It is also possible to create the HTML version of the manual within
the <a class="reference internal" href="Build_cmake.html"><span class="doc">CMake build directory</span></a>.  The reason for this
option is to include the installation of the HTML manual pages into
the “install” step when installing LAMMPS after the CMake build via
<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-D <span class="nv">BUILD_DOC</span><span class="o">=</span>value       <span class="c1"># yes or no (default)</span>
</pre></div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="build-lammps-tools">
<span id="tools"></span><h2><span class="section-number">3.4.5. </span>Build LAMMPS tools</h2>
<p>Some tools described in <a class="reference internal" href="Tools.html"><span class="doc">Auxiliary tools</span></a> can be built directly
using CMake or Make.</p>
<p><strong>CMake build3</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-D <span class="nv">BUILD_TOOLS</span><span class="o">=</span>value       <span class="c1"># yes or no (default)</span>
</pre></div>
</div>
<p>The generated binaries will also become part of the LAMMPS installation
(see below).</p>
<p><strong>Traditional make</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> lammps/tools
make all              <span class="c1"># build all binaries of tools</span>
make binary2txt       <span class="c1"># build only binary2txt tool</span>
make chain            <span class="c1"># build only chain tool</span>
make micelle2d        <span class="c1"># build only micelle2d tool</span>
make thermo_extract   <span class="c1"># build only thermo_extract tool</span>
</pre></div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="install-lammps-after-a-build">
<span id="install"></span><h2><span class="section-number">3.4.6. </span>Install LAMMPS after a build</h2>
<p>After building LAMMPS, you may wish to copy the LAMMPS executable of
library, along with other LAMMPS files (library header, doc files) to
a globally visible place on your system, for others to access.  Note
that you may need super-user privileges (e.g. sudo) if the directory
you want to copy files to is protected.</p>
<p><strong>CMake build</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake -D <span class="nv">CMAKE_INSTALL_PREFIX</span><span class="o">=</span>path <span class="o">[</span>options ...<span class="o">]</span> ../cmake
make                        <span class="c1"># perform make after CMake command</span>
make install                <span class="c1"># perform the installation into prefix</span>
</pre></div>
</div>
<p><strong>Traditional make</strong>:</p>
<p>There is no “install” option in the <code class="docutils literal notranslate"><span class="pre">src/Makefile</span></code> for LAMMPS.  If
you wish to do this you will need to first build LAMMPS, then manually
copy the desired LAMMPS files to the appropriate system directories.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Build_settings.html" class="btn btn-neutral float-right" title="3.5. Optional build settings" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Build_link.html" class="btn btn-neutral" title="3.3. Link LAMMPS as a library to another code" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr style="margin-top: 6px; margin-bottom: 6px;" width="100%"/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2003-2020 Sandia Corporation.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/mathjax/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>